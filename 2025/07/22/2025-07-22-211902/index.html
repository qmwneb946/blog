<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>演化动力学与种群遗传学：解码生命变迁的数学旋律 | qmwneb946 的博客</title><meta name="author" content="qmwneb946"><meta name="copyright" content="qmwneb946"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="你好，各位技术与数学爱好者！我是 qmwneb946，今天我们将一同踏上一段穿越时间与基因的旅程，深入探索一个既古老又现代、既宏大又精微的领域——演化动力学与种群遗传学。 当我们谈论“演化”时，脑海中可能浮现出达尔文、加拉帕戈斯群岛的雀鸟，或是“适者生存”这句耳熟能详的口号。然而，演化绝非仅仅是历史的记载或哲学思辨，它是一系列可被量化、可被建模、可被模拟的动态过程。在生物学、数学、统计学乃至计算机">
<meta property="og:type" content="article">
<meta property="og:title" content="演化动力学与种群遗传学：解码生命变迁的数学旋律">
<meta property="og:url" content="https://qmwneb946.dpdns.org/2025/07/22/2025-07-22-211902/index.html">
<meta property="og:site_name" content="qmwneb946 的博客">
<meta property="og:description" content="你好，各位技术与数学爱好者！我是 qmwneb946，今天我们将一同踏上一段穿越时间与基因的旅程，深入探索一个既古老又现代、既宏大又精微的领域——演化动力学与种群遗传学。 当我们谈论“演化”时，脑海中可能浮现出达尔文、加拉帕戈斯群岛的雀鸟，或是“适者生存”这句耳熟能详的口号。然而，演化绝非仅仅是历史的记载或哲学思辨，它是一系列可被量化、可被建模、可被模拟的动态过程。在生物学、数学、统计学乃至计算机">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://qmwneb946.dpdns.org/img/icon.png">
<meta property="article:published_time" content="2025-07-22T13:19:02.000Z">
<meta property="article:modified_time" content="2025-07-23T05:13:21.735Z">
<meta property="article:author" content="qmwneb946">
<meta property="article:tag" content="2025">
<meta property="article:tag" content="数学">
<meta property="article:tag" content="演化动力学与种群遗传学">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://qmwneb946.dpdns.org/img/icon.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "演化动力学与种群遗传学：解码生命变迁的数学旋律",
  "url": "https://qmwneb946.dpdns.org/2025/07/22/2025-07-22-211902/",
  "image": "https://qmwneb946.dpdns.org/img/icon.png",
  "datePublished": "2025-07-22T13:19:02.000Z",
  "dateModified": "2025-07-23T05:13:21.735Z",
  "author": [
    {
      "@type": "Person",
      "name": "qmwneb946",
      "url": "https://github.com/qmwneb946"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://qmwneb946.dpdns.org/2025/07/22/2025-07-22-211902/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.json","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '演化动力学与种群遗传学：解码生命变迁的数学旋律',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2845632165165414" crossorigin="anonymous"></script><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="qmwneb946 的博客" type="application/atom+xml">
</head><body><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">qmwneb946 的博客</span></a><a class="nav-page-title" href="/"><span class="site-name">演化动力学与种群遗传学：解码生命变迁的数学旋律</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  返回首页</span></span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">演化动力学与种群遗传学：解码生命变迁的数学旋律<a class="post-edit-link" href="https://github.com/qmwneb946/blog/edit/main/source/_posts/2025-07-22-211902.md" title="编辑" target="_blank"><i class="fas fa-pencil-alt"></i></a></h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-07-22T13:19:02.000Z" title="发表于 2025-07-22 21:19:02">2025-07-22</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-07-23T05:13:21.735Z" title="更新于 2025-07-23 13:13:21">2025-07-23</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%95%B0%E5%AD%A6/">数学</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div><article class="container post-content" id="article-container"><p>你好，各位技术与数学爱好者！我是 qmwneb946，今天我们将一同踏上一段穿越时间与基因的旅程，深入探索一个既古老又现代、既宏大又精微的领域——<strong>演化动力学与种群遗传学</strong>。</p>
<p>当我们谈论“演化”时，脑海中可能浮现出达尔文、加拉帕戈斯群岛的雀鸟，或是“适者生存”这句耳熟能详的口号。然而，演化绝非仅仅是历史的记载或哲学思辨，它是一系列可被量化、可被建模、可被模拟的动态过程。在生物学、数学、统计学乃至计算机科学的交汇点，演化动力学和种群遗传学构筑了一座宏伟的知识殿堂，让我们得以用数学的语言来“阅读”生命变迁的乐谱，用计算的工具来“演奏”基因舞蹈的旋律。</p>
<p><strong>种群遗传学 (Population Genetics)</strong> 是研究在群体中基因和基因型频率如何随时间变化的学科。它关注的是遗传变异的来源、分布以及遗传物质的传递规律。它提供了演化机制得以作用的“舞台”和“演员”。而 <strong>演化动力学 (Evolutionary Dynamics)</strong> 则更侧重于这些频率变化背后的驱动力，以及它们如何在时间尺度上塑造生物体的性状、物种的形成乃至生态系统的演变。简而言之，种群遗传学告诉我们“有什么”和“有多少”，而演化动力学则解释“为什么变”和“如何变”。</p>
<p>在这篇深度博客中，我们将从孟德尔遗传的基石出发，逐步深入到哈迪-温伯格平衡的数学优美，剖析自然选择、遗传漂变等核心演化机制的动力学原理，探讨多基因性状的复杂性，最终触及计算模拟在前沿研究中的不可或缺。系好安全带，准备好你的纸笔，因为我们将用代码和公式，共同揭示生命演化的数学之美。</p>
<hr>
<h2 id="一、-基石：孟德尔遗传与群体遗传学原理">一、 基石：孟德尔遗传与群体遗传学原理</h2>
<p>要理解群体层面的演化，我们首先需要回到个体层面的遗传，这便是由格雷戈尔·孟德尔在19世纪中叶奠定的基础。他的豌豆实验揭示了遗传的颗粒性本质，而非当时流行的“混合遗传”观念。</p>
<h3 id="孟德尔定律的重新审视">孟德尔定律的重新审视</h3>
<p>孟德尔的<strong>分离定律</strong>指出，在配子形成过程中，一对等位基因会彼此分离，每个配子只获得其中的一个。这意味着，如果你是某个基因座上的杂合子（Aa），你将以50%的概率将A传给后代，50%的概率将a传给后代。<strong>独立分配定律</strong>则进一步说明，不同基因座上的等位基因是独立分配的，这为遗传变异的组合提供了无限可能。</p>
<p>这些看似简单的定律，却为我们理解群体中的基因频率变化提供了微观基础。在群体中，我们不再关注单个个体的遗传，而是关注所有个体中特定等位基因或基因型的相对比例。</p>
<h3 id="群体遗传学的基本概念">群体遗传学的基本概念</h3>
<h4 id="1-基因库与等位基因频率">1. 基因库与等位基因频率</h4>
<p>一个<strong>种群 (Population)</strong> 是指在特定区域内能够相互交配并产生可育后代的所有个体。一个种群的<strong>基因库 (Gene Pool)</strong> 则是该种群中所有个体所拥有的全部基因和等位基因的总和。</p>
<p>在基因库中，我们最关心的参数之一就是<strong>等位基因频率 (Allele Frequency)</strong>。假设在一个二倍体种群中，某个基因座有两种等位基因：显性等位基因A和隐性等位基因a。如果A的频率为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span>，a的频率为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span>，那么由于它们是唯一的两种等位基因，我们有：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>p</mi><mo>+</mo><mi>q</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">p + q = 1 
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></span></p>
<p>等位基因频率是群体遗传学研究的核心，因为演化过程本质上就是等位基因频率随时间发生变化的过程。</p>
<h4 id="2-基因型频率">2. 基因型频率</h4>
<p>除了等位基因频率，我们还可以计算<strong>基因型频率 (Genotype Frequency)</strong>。在一个具有A和a等位基因的基因座上，可能存在三种基因型：AA、Aa和aa。假设它们的频率分别为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mrow><mi>A</mi><mi>A</mi></mrow></msub></mrow><annotation encoding="application/x-tex">f_{AA}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">AA</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mrow><mi>A</mi><mi>a</mi></mrow></msub></mrow><annotation encoding="application/x-tex">f_{Aa}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight">a</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>和<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mrow><mi>a</mi><mi>a</mi></mrow></msub></mrow><annotation encoding="application/x-tex">f_{aa}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">aa</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>。同样，所有基因型频率之和为1：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>f</mi><mrow><mi>A</mi><mi>A</mi></mrow></msub><mo>+</mo><msub><mi>f</mi><mrow><mi>A</mi><mi>a</mi></mrow></msub><mo>+</mo><msub><mi>f</mi><mrow><mi>a</mi><mi>a</mi></mrow></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">f_{AA} + f_{Aa} + f_{aa} = 1 
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">AA</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight">a</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">aa</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></span></p>
<p>等位基因频率和基因型频率之间存在关联。例如，我们可以从基因型频率计算等位基因频率：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>p</mi><mo>=</mo><msub><mi>f</mi><mrow><mi>A</mi><mi>A</mi></mrow></msub><mo>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msub><mi>f</mi><mrow><mi>A</mi><mi>a</mi></mrow></msub></mrow><annotation encoding="application/x-tex">p = f_{AA} + \frac{1}{2}f_{Aa} 
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">AA</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight">a</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>q</mi><mo>=</mo><msub><mi>f</mi><mrow><mi>a</mi><mi>a</mi></mrow></msub><mo>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msub><mi>f</mi><mrow><mi>A</mi><mi>a</mi></mrow></msub></mrow><annotation encoding="application/x-tex">q = f_{aa} + \frac{1}{2}f_{Aa} 
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">aa</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight">a</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<h4 id="3-哈迪-温伯格平衡：演化的“零假设”">3. 哈迪-温伯格平衡：演化的“零假设”</h4>
<p>哈迪-温伯格平衡 (Hardy-Weinberg Equilibrium, HWE) 是群体遗传学中最基础也是最重要的原理之一。它描述了在没有演化力量作用下，等位基因频率和基因型频率在世代之间保持不变的理想状态。HWE的假设条件包括：</p>
<ul>
<li><strong>没有突变 (No Mutation):</strong> 没有新的等位基因产生，也没有等位基因之间的转换。</li>
<li><strong>没有选择 (No Selection):</strong> 所有基因型具有相同的生存率和繁殖率。</li>
<li><strong>没有基因流 (No Gene Flow):</strong> 没有个体进出种群，没有等位基因的引入或移出。</li>
<li><strong>随机交配 (Random Mating):</strong> 个体在交配时不受基因型影响，即任意个体与任意其他个体交配的概率相等。</li>
<li><strong>种群足够大 (Large Population Size):</strong> 避免随机事件（如遗传漂变）对频率的影响。</li>
</ul>
<p>如果一个种群满足这些条件，那么在下一代中，基因型频率将达到以下平衡状态：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>f</mi><mrow><mi>A</mi><mi>A</mi></mrow></msub><mo>=</mo><msup><mi>p</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">f_{AA} = p^2 
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">AA</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0585em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>f</mi><mrow><mi>A</mi><mi>a</mi></mrow></msub><mo>=</mo><mn>2</mn><mi>p</mi><mi>q</mi></mrow><annotation encoding="application/x-tex">f_{Aa} = 2pq 
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight">a</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.03588em;">pq</span></span></span></span></span></p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>f</mi><mrow><mi>a</mi><mi>a</mi></mrow></msub><mo>=</mo><msup><mi>q</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">f_{aa} = q^2 
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">aa</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0585em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>其中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span>和<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span>是当前的等位基因频率。因此，我们有 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>p</mi><mn>2</mn></msup><mo>+</mo><mn>2</mn><mi>p</mi><mi>q</mi><mo>+</mo><msup><mi>q</mi><mn>2</mn></msup><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">p^2 + 2pq + q^2 = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0085em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.03588em;">pq</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0085em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>。</p>
<p>HWE的重要性在于，它提供了一个“零假设”。如果一个种群的基因型频率偏离了HWE预测的值，那么这强烈暗示着某种演化力量正在起作用。</p>
<p>让我们用一个简单的Python代码来演示如何根据等位基因频率计算哈迪-温伯格平衡下的基因型频率，并检查一个实际种群是否处于平衡状态。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">calculate_hwe_frequencies</span>(<span class="params">p</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    根据等位基因A的频率p计算哈迪-温伯格平衡下的基因型频率。</span></span><br><span class="line"><span class="string">    q = 1 - p</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    q = <span class="number">1</span> - p</span><br><span class="line">    f_AA = p**<span class="number">2</span></span><br><span class="line">    f_Aa = <span class="number">2</span> * p * q</span><br><span class="line">    f_aa = q**<span class="number">2</span></span><br><span class="line">    <span class="keyword">return</span> f_AA, f_Aa, f_aa</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check_hwe</span>(<span class="params">observed_genotype_counts</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    检查给定基因型计数是否符合哈迪-温伯格平衡。</span></span><br><span class="line"><span class="string">    observed_genotype_counts: 一个字典，形如 &#123;&#x27;AA&#x27;: count_AA, &#x27;Aa&#x27;: count_Aa, &#x27;aa&#x27;: count_aa&#125;</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    total_individuals = <span class="built_in">sum</span>(observed_genotype_counts.values())</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> total_individuals == <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;种群大小为0，无法检查HWE。&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 计算观察到的基因型频率</span></span><br><span class="line">    obs_f_AA = observed_genotype_counts.get(<span class="string">&#x27;AA&#x27;</span>, <span class="number">0</span>) / total_individuals</span><br><span class="line">    obs_f_Aa = observed_genotype_counts.get(<span class="string">&#x27;Aa&#x27;</span>, <span class="number">0</span>) / total_individuals</span><br><span class="line">    obs_f_aa = observed_genotype_counts.get(<span class="string">&#x27;aa&#x27;</span>, <span class="number">0</span>) / total_individuals</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;观察到的基因型频率：AA=<span class="subst">&#123;obs_f_AA:<span class="number">.4</span>f&#125;</span>, Aa=<span class="subst">&#123;obs_f_Aa:<span class="number">.4</span>f&#125;</span>, aa=<span class="subst">&#123;obs_f_aa:<span class="number">.4</span>f&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 从观察到的基因型频率计算等位基因频率</span></span><br><span class="line">    p_obs = obs_f_AA + <span class="number">0.5</span> * obs_f_Aa</span><br><span class="line">    q_obs = obs_f_aa + <span class="number">0.5</span> * obs_f_Aa</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;观察到的等位基因频率：p(A)=<span class="subst">&#123;p_obs:<span class="number">.4</span>f&#125;</span>, q(a)=<span class="subst">&#123;q_obs:<span class="number">.4</span>f&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 计算哈迪-温伯格平衡下的预期基因型频率</span></span><br><span class="line">    exp_f_AA, exp_f_Aa, exp_f_aa = calculate_hwe_frequencies(p_obs)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;预期哈迪-温伯格基因型频率：AA=<span class="subst">&#123;exp_f_AA:<span class="number">.4</span>f&#125;</span>, Aa=<span class="subst">&#123;exp_f_Aa:<span class="number">.4</span>f&#125;</span>, aa=<span class="subst">&#123;exp_f_aa:<span class="number">.4</span>f&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 简单比较（在实际统计中会使用卡方检验）</span></span><br><span class="line">    tolerance = <span class="number">0.01</span> <span class="comment"># 允许的误差范围</span></span><br><span class="line">    is_hwe = (<span class="built_in">abs</span>(obs_f_AA - exp_f_AA) &lt; tolerance <span class="keyword">and</span></span><br><span class="line">              <span class="built_in">abs</span>(obs_f_Aa - exp_f_Aa) &lt; tolerance <span class="keyword">and</span></span><br><span class="line">              <span class="built_in">abs</span>(obs_f_aa - exp_f_aa) &lt; tolerance)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> is_hwe:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;该种群大致符合哈迪-温伯格平衡。&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;该种群不符合哈迪-温伯格平衡，可能存在演化力量。&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 实际应用中会使用卡方检验：</span></span><br><span class="line">    <span class="comment"># from scipy.stats import chi2_contingency</span></span><br><span class="line">    <span class="comment"># observed = [observed_genotype_counts.get(&#x27;AA&#x27;, 0), observed_genotype_counts.get(&#x27;Aa&#x27;, 0), observed_genotype_counts.get(&#x27;aa&#x27;, 0)]</span></span><br><span class="line">    <span class="comment"># expected = [exp_f_AA * total_individuals, exp_f_Aa * total_individuals, exp_f_aa * total_individuals]</span></span><br><span class="line">    <span class="comment"># chi2, p_value, _, _ = chi2_contingency([observed, expected])</span></span><br><span class="line">    <span class="comment"># print(f&quot;卡方检验 P 值: &#123;p_value:.4f&#125;&quot;)</span></span><br><span class="line">    <span class="comment"># if p_value &lt; 0.05: print(&quot;统计学上显著偏离HWE。&quot;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 示例使用</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;--- 示例 1: 接近HWE的种群 ---&quot;</span>)</span><br><span class="line"><span class="comment"># 假设一个等位基因A频率为0.6的种群，预期AA=0.36, Aa=0.48, aa=0.16</span></span><br><span class="line"><span class="comment"># 假设种群有1000个体</span></span><br><span class="line">observed_counts_1 = &#123;<span class="string">&#x27;AA&#x27;</span>: <span class="number">360</span>, <span class="string">&#x27;Aa&#x27;</span>: <span class="number">480</span>, <span class="string">&#x27;aa&#x27;</span>: <span class="number">160</span>&#125;</span><br><span class="line">check_hwe(observed_counts_1)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n--- 示例 2: 偏离HWE的种群 (例如，AA个体数量异常高) ---&quot;</span>)</span><br><span class="line"><span class="comment"># 假设一个种群AA个体异常高，可能是定向选择作用</span></span><br><span class="line">observed_counts_2 = &#123;<span class="string">&#x27;AA&#x27;</span>: <span class="number">500</span>, <span class="string">&#x27;Aa&#x27;</span>: <span class="number">300</span>, <span class="string">&#x27;aa&#x27;</span>: <span class="number">200</span>&#125;</span><br><span class="line">check_hwe(observed_counts_2)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n--- 示例 3: 偏离HWE的种群 (例如，杂合子缺失，可能是近亲繁殖) ---&quot;</span>)</span><br><span class="line"><span class="comment"># 杂合子缺失是近亲繁殖的标志</span></span><br><span class="line">observed_counts_3 = &#123;<span class="string">&#x27;AA&#x27;</span>: <span class="number">400</span>, <span class="string">&#x27;Aa&#x27;</span>: <span class="number">200</span>, <span class="string">&#x27;aa&#x27;</span>: <span class="number">400</span>&#125;</span><br><span class="line">check_hwe(observed_counts_3)</span><br></pre></td></tr></table></figure>
<p>这个代码展示了如何从数据中推断基因型和等位基因频率，并初步判断是否符合HWE。在实际的群体遗传学分析中，我们会使用统计学上的卡方检验来严格判断偏离是否显著。</p>
<h3 id="遗传变异的来源">遗传变异的来源</h3>
<p>HWE的假设条件反过来也指明了驱动演化的力量：</p>
<ul>
<li><strong>突变 (Mutation):</strong> 等位基因从一种形式变为另一种形式，是新遗传变异的根本来源。</li>
<li><strong>基因流 (Gene Flow / Migration):</strong> 个体或配子在不同种群之间移动，导致等位基因的交换。</li>
<li><strong>遗传漂变 (Genetic Drift):</strong> 在小种群中，等位基因频率由于随机抽样误差而发生波动。</li>
<li><strong>自然选择 (Natural Selection):</strong> 某些基因型比其他基因型在生存和繁殖上具有优势。</li>
<li><strong>非随机交配 (Non-random Mating):</strong> 例如同型交配（assortative mating）或近亲繁殖（inbreeding），直接影响基因型频率，但本身不直接改变等位基因频率。</li>
</ul>
<p>接下来的章节，我们将深入探讨这些核心演化机制如何以动力学的方式驱动等位基因频率在种群中发生变化。</p>
<hr>
<h2 id="二、-驱动力：演化机制的动力学分析">二、 驱动力：演化机制的动力学分析</h2>
<p>了解了群体遗传学的基本概念和HWE的零假设后，我们现在可以深入探讨那些真正推动生命演化的动力——那些使等位基因频率偏离HWE的“力量”。</p>
<h3 id="自然选择：适应度与生存斗争的量化">自然选择：适应度与生存斗争的量化</h3>
<p><strong>自然选择 (Natural Selection)</strong> 是演化最核心的机制。它基于三个基本要素：</p>
<ol>
<li><strong>变异 (Variation):</strong> 种群中的个体在可遗传的性状上存在差异。</li>
<li><strong>遗传 (Inheritance):</strong> 这些性状差异可以从亲代传递给子代。</li>
<li><strong>差异繁殖与生存 (Differential Reproduction and Survival):</strong> 拥有某些性状的个体比其他个体更能适应环境，从而留下更多后代。</li>
</ol>
<p>自然选择的数学表述依赖于<strong>适应度 (Fitness)</strong> 这个概念。适应度通常用符号<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span></span></span>表示，衡量一个基因型在特定环境下的繁殖成功率。我们通常使用<strong>相对适应度 (Relative Fitness)</strong>，即将某个基因型的适应度标准化，通常以最具适应度的基因型为1。</p>
<p>假设一个基因座有A和a两种等位基因，三种基因型AA、Aa、aa的相对适应度分别为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mrow><mi>A</mi><mi>A</mi></mrow></msub></mrow><annotation encoding="application/x-tex">w_{AA}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">AA</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mrow><mi>A</mi><mi>a</mi></mrow></msub></mrow><annotation encoding="application/x-tex">w_{Aa}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight">a</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mrow><mi>a</mi><mi>a</mi></mrow></msub></mrow><annotation encoding="application/x-tex">w_{aa}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">aa</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>。<br>
选择作用会导致等位基因频率在世代之间发生变化。让我们考虑最简单的模型：单基因座、两等位基因、离散世代、常数适应度。</p>
<p>假设在第<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span>代，等位基因A的频率为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">p_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，等位基因a的频率为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>q</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">q_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>。<br>
根据哈迪-温伯格原理，如果随机交配，则后代（受精卵）的基因型频率为：<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mrow><mi>A</mi><mi>A</mi></mrow></msub><mo>=</mo><msubsup><mi>p</mi><mi>t</mi><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">f_{AA} = p_t^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">AA</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0611em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mrow><mi>A</mi><mi>a</mi></mrow></msub><mo>=</mo><mn>2</mn><msub><mi>p</mi><mi>t</mi></msub><msub><mi>q</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">f_{Aa} = 2 p_t q_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight">a</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mrow><mi>a</mi><mi>a</mi></mrow></msub><mo>=</mo><msubsup><mi>q</mi><mi>t</mi><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">f_{aa} = q_t^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">aa</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0611em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.453em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span></p>
<p>考虑到适应度，这些基因型存活到繁殖期并成功繁殖的个体比例将是：<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>p</mi><mi>t</mi><mn>2</mn></msubsup><msub><mi>w</mi><mrow><mi>A</mi><mi>A</mi></mrow></msub></mrow><annotation encoding="application/x-tex">p_t^2 w_{AA}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0611em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">AA</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> (对于AA)<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><msub><mi>p</mi><mi>t</mi></msub><msub><mi>q</mi><mi>t</mi></msub><msub><mi>w</mi><mrow><mi>A</mi><mi>a</mi></mrow></msub></mrow><annotation encoding="application/x-tex">2 p_t q_t w_{Aa}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight">a</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> (对于Aa)<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>q</mi><mi>t</mi><mn>2</mn></msubsup><msub><mi>w</mi><mrow><mi>a</mi><mi>a</mi></mrow></msub></mrow><annotation encoding="application/x-tex">q_t^2 w_{aa}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0611em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.453em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">aa</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> (对于aa)</p>
<p>为了得到下一代的等位基因频率<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">p_{t+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span>，我们首先需要计算种群的平均适应度 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>w</mi><mo>ˉ</mo></mover></mrow><annotation encoding="application/x-tex">\bar{w}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5678em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">ˉ</span></span></span></span></span></span></span></span></span></span>：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mover accent="true"><mi>w</mi><mo>ˉ</mo></mover><mo>=</mo><msubsup><mi>p</mi><mi>t</mi><mn>2</mn></msubsup><msub><mi>w</mi><mrow><mi>A</mi><mi>A</mi></mrow></msub><mo>+</mo><mn>2</mn><msub><mi>p</mi><mi>t</mi></msub><msub><mi>q</mi><mi>t</mi></msub><msub><mi>w</mi><mrow><mi>A</mi><mi>a</mi></mrow></msub><mo>+</mo><msubsup><mi>q</mi><mi>t</mi><mn>2</mn></msubsup><msub><mi>w</mi><mrow><mi>a</mi><mi>a</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\bar{w} = p_t^2 w_{AA} + 2 p_t q_t w_{Aa} + q_t^2 w_{aa} 
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5678em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1111em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">AA</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight">a</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1111em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">aa</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<p>然后，下一代等位基因A的频率 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">p_{t+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span> 可以表示为：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>p</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mfrac><mrow><msubsup><mi>p</mi><mi>t</mi><mn>2</mn></msubsup><msub><mi>w</mi><mrow><mi>A</mi><mi>A</mi></mrow></msub><mo>+</mo><msub><mi>p</mi><mi>t</mi></msub><msub><mi>q</mi><mi>t</mi></msub><msub><mi>w</mi><mrow><mi>A</mi><mi>a</mi></mrow></msub></mrow><mover accent="true"><mi>w</mi><mo>ˉ</mo></mover></mfrac></mrow><annotation encoding="application/x-tex">p_{t+1} = \frac{p_t^2 w_{AA} + p_t q_t w_{Aa}}{\bar{w}} 
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.1771em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4911em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">ˉ</span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">AA</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight">a</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p>同理，下一代等位基因a的频率 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>q</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">q_{t+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span> 为：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>q</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mfrac><mrow><msubsup><mi>q</mi><mi>t</mi><mn>2</mn></msubsup><msub><mi>w</mi><mrow><mi>a</mi><mi>a</mi></mrow></msub><mo>+</mo><msub><mi>p</mi><mi>t</mi></msub><msub><mi>q</mi><mi>t</mi></msub><msub><mi>w</mi><mrow><mi>A</mi><mi>a</mi></mrow></msub></mrow><mover accent="true"><mi>w</mi><mo>ˉ</mo></mover></mfrac></mrow><annotation encoding="application/x-tex">q_{t+1} = \frac{q_t^2 w_{aa} + p_t q_t w_{Aa}}{\bar{w}} 
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.1771em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4911em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">ˉ</span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.453em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">aa</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight">a</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p>（注意：分子的<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>t</mi></msub><msub><mi>q</mi><mi>t</mi></msub><msub><mi>w</mi><mrow><mi>A</mi><mi>a</mi></mrow></msub></mrow><annotation encoding="application/x-tex">p_t q_t w_{Aa}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight">a</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>表示Aa基因型贡献给A等位基因的比例，因为Aa有A和a各一半。）</p>
<p>这个方程构成了自然选择动力学的基础。通过迭代这个方程，我们可以预测等位基因频率随时间的变化轨迹。</p>
<h3 id="选择的类型">选择的类型</h3>
<p>根据适应度函数与基因型或性状的关系，自然选择可以分为几种基本类型：</p>
<ul>
<li><strong>定向选择 (Directional Selection):</strong> 偏好一个极端性状，导致等位基因频率向一个方向持续改变，直到该等位基因固定或丢失。例如，抗生素耐药性基因的传播。</li>
<li><strong>稳定选择 (Stabilizing Selection):</strong> 偏好中间性状，消除极端变异，导致等位基因频率趋于稳定。例如，人类婴儿的出生体重。</li>
<li><strong>分裂选择 (Disruptive Selection):</strong> 偏好两个或多个极端性状，反对中间性状，可能导致物种分化。例如，生活在不同食物来源上的喙型。</li>
</ul>
<h3 id="遗传漂变：随机的力量">遗传漂变：随机的力量</h3>
<p>与确定性的自然选择不同，<strong>遗传漂变 (Genetic Drift)</strong> 是等位基因频率在有限大小的种群中由于随机抽样误差而发生波动的过程。这种随机性在小种群中尤为显著。想象一下，你有一个小袋子，里面有等量的红色和蓝色弹珠（代表A和a等位基因）。如果你每次只随机抽取很少的弹珠来代表下一代，那么红蓝比例很可能与袋子里原来的比例不符。</p>
<p>遗传漂变的主要后果包括：</p>
<ul>
<li><strong>等位基因的随机固定或丢失:</strong> 某个等位基因的频率可能随机上升到1（固定）或下降到0（丢失），即使它并不提供适应度优势。</li>
<li><strong>遗传多样性降低:</strong> 随着等位基因的固定或丢失，种群的遗传变异性会下降。</li>
<li><strong>种群间分化:</strong> 由于不同种群中漂变事件的随机性，即使最初它们等位基因频率相同，最终也可能分化出显著差异。</li>
</ul>
<p>两个典型的遗传漂变效应是：</p>
<ul>
<li><strong>瓶颈效应 (Bottleneck Effect):</strong> 种群规模在短时间内急剧缩小（例如，自然灾害），幸存下来的个体所携带的等位基因可能无法代表原种群的全部遗传多样性。</li>
<li><strong>创始人效应 (Founder Effect):</strong> 一小部分个体从原种群中分离出来，建立新种群。新种群的基因库仅限于这少数创始个体所携带的等位基因，可能与原种群存在显著差异。</li>
</ul>
<p><strong>Wright-Fisher 模型</strong> 和 <strong>Moran 模型</strong> 是描述遗传漂变过程的两种经典数学模型。它们都是马尔可夫链模型，描述了等位基因频率在离散世代（Wright-Fisher）或连续时间（Moran）上随机演变的概率分布。</p>
<p>让我们用Python模拟一个简单的遗传漂变过程，看看在不同种群大小下等位基因频率如何随机波动。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">simulate_genetic_drift</span>(<span class="params">initial_p, population_size, generations</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    模拟遗传漂变过程。</span></span><br><span class="line"><span class="string">    initial_p: 初始等位基因A的频率</span></span><br><span class="line"><span class="string">    population_size: 种群大小 (2N，因为每个个体有2个等位基因)</span></span><br><span class="line"><span class="string">    generations: 模拟的代数</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    p_history = [initial_p]</span><br><span class="line">    num_A_alleles = <span class="built_in">int</span>(initial_p * <span class="number">2</span> * population_size) <span class="comment"># 初始A等位基因数量</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(generations - <span class="number">1</span>):</span><br><span class="line">        <span class="comment"># 模拟下一代等位基因的抽取</span></span><br><span class="line">        <span class="comment"># 每个个体有2个等位基因，所以总共有 2 * population_size 个等位基因</span></span><br><span class="line">        <span class="comment"># 从当前基因库中随机抽取 2 * population_size 次</span></span><br><span class="line">        <span class="comment"># 使用二项式分布来模拟这个随机过程</span></span><br><span class="line">        num_A_alleles_next_gen = np.random.binomial(<span class="number">2</span> * population_size, p_history[-<span class="number">1</span>])</span><br><span class="line">        </span><br><span class="line">        p_next_gen = num_A_alleles_next_gen / (<span class="number">2</span> * population_size)</span><br><span class="line">        p_history.append(p_next_gen)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 如果等位基因固定或丢失，则停止模拟</span></span><br><span class="line">        <span class="keyword">if</span> p_next_gen == <span class="number">0</span> <span class="keyword">or</span> p_next_gen == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">            </span><br><span class="line">    <span class="keyword">return</span> p_history</span><br><span class="line"></span><br><span class="line"><span class="comment"># 模拟参数</span></span><br><span class="line">initial_p = <span class="number">0.5</span></span><br><span class="line">generations = <span class="number">200</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 比较不同种群大小下的漂变</span></span><br><span class="line">pop_sizes = [<span class="number">10</span>, <span class="number">50</span>, <span class="number">200</span>, <span class="number">1000</span>] <span class="comment"># 较小的种群，漂变效应更明显</span></span><br><span class="line"></span><br><span class="line">plt.figure(figsize=(<span class="number">12</span>, <span class="number">8</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> pop_size <span class="keyword">in</span> pop_sizes:</span><br><span class="line">    <span class="comment"># 运行多次模拟以展示随机性</span></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>): <span class="comment"># 每个种群大小运行5条轨迹</span></span><br><span class="line">        drift_trajectory = simulate_genetic_drift(initial_p, pop_size, generations)</span><br><span class="line">        plt.plot(drift_trajectory, alpha=<span class="number">0.7</span>, label=<span class="string">f&#x27;Pop Size <span class="subst">&#123;pop_size&#125;</span>&#x27;</span> <span class="keyword">if</span> _ == <span class="number">0</span> <span class="keyword">else</span> <span class="string">&quot;&quot;</span>) <span class="comment"># 只显示一个label</span></span><br><span class="line">    </span><br><span class="line">plt.title(<span class="string">&#x27;遗传漂变模拟 (等位基因A的频率随时间变化)&#x27;</span>, fontsize=<span class="number">16</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;代数&#x27;</span>, fontsize=<span class="number">14</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;等位基因A的频率 (p)&#x27;</span>, fontsize=<span class="number">14</span>)</span><br><span class="line">plt.axhline(initial_p, color=<span class="string">&#x27;gray&#x27;</span>, linestyle=<span class="string">&#x27;--&#x27;</span>, label=<span class="string">&#x27;初始频率&#x27;</span>)</span><br><span class="line">plt.legend()</span><br><span class="line">plt.grid(<span class="literal">True</span>)</span><br><span class="line">plt.ylim(<span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p>从图上可以看到，在小种群中，等位基因频率的波动非常剧烈，很快就会出现等位基因的固定（频率达到1）或丢失（频率降至0）。而大种群的频率则相对稳定，更接近初始频率，且更难达到固定或丢失。这直观地展示了种群大小对遗传漂变影响的程度。</p>
<h3 id="突变：变异的终极来源">突变：变异的终极来源</h3>
<p><strong>突变 (Mutation)</strong> 是指DNA序列或染色体结构发生永久性改变。它是产生新等位基因和增加遗传变异的根本来源。尽管单个突变的发生率通常很低（例如，每基因座每代<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>10</mn><mrow><mo>−</mo><mn>5</mn></mrow></msup></mrow><annotation encoding="application/x-tex">10^{-5}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">5</span></span></span></span></span></span></span></span></span></span></span></span>到<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>10</mn><mrow><mo>−</mo><mn>6</mn></mrow></msup></mrow><annotation encoding="application/x-tex">10^{-6}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">6</span></span></span></span></span></span></span></span></span></span></span></span>），但它们是演化的原始动力。</p>
<p>在没有其他演化力量（如选择）的情况下，突变也会导致等位基因频率发生缓慢但持续的变化。假设等位基因A突变为a的突变率为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi></mrow><annotation encoding="application/x-tex">\mu</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">μ</span></span></span></span>，a突变为A的突变率为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ν</mi></mrow><annotation encoding="application/x-tex">\nu</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.06366em;">ν</span></span></span></span>。那么下一代A的频率<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">p_{t+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span>将是：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>p</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>p</mi><mi>t</mi></msub><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>μ</mi><mo stretchy="false">)</mo><mo>+</mo><msub><mi>q</mi><mi>t</mi></msub><mi>ν</mi></mrow><annotation encoding="application/x-tex">p_{t+1} = p_t (1 - \mu) + q_t \nu 
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">μ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.06366em;">ν</span></span></span></span></span></p>
<p>最终，在足够长的时间内，等位基因频率会达到一个突变平衡点，即使没有选择，也会维持一定的遗传多样性。</p>
<h3 id="基因流：连接种群的纽带">基因流：连接种群的纽带</h3>
<p><strong>基因流 (Gene Flow)</strong>，也称为迁移 (Migration)，是指个体或其配子（如花粉）在不同种群之间移动，并成功交配产生后代的过程。基因流会引入新的等位基因，或改变现有等位基因的频率。</p>
<p>基因流的主要作用是<strong>同质化 (Homogenizing Effect)</strong>：它倾向于使不同种群之间的等位基因频率趋于一致，从而减少种群间的分化。<br>
假设一个“接收”种群的等位基因A频率为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>r</mi></msub></mrow><annotation encoding="application/x-tex">p_r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，一个“源”种群的等位基因A频率为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">p_s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>。如果每代有比例为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span>的个体从源种群迁移到接收种群，那么接收种群下一代的A频率<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mrow><mi>r</mi><mo separator="true">,</mo><mi>n</mi><mi>e</mi><mi>x</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">p_{r, next}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">x</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>将是：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>p</mi><mrow><mi>r</mi><mo separator="true">,</mo><mi>n</mi><mi>e</mi><mi>x</mi><mi>t</mi></mrow></msub><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>m</mi><mo stretchy="false">)</mo><msub><mi>p</mi><mi>r</mi></msub><mo>+</mo><mi>m</mi><msub><mi>p</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">p_{r, next} = (1 - m) p_r + m p_s 
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">x</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">m</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<p>这个简单的模型表明，即使只有很小的基因流，也能有效地阻止不同种群因遗传漂变或局部选择而产生的显著遗传分化。</p>
<hr>
<h2 id="三、-复杂性：多基因性状与量化遗传学">三、 复杂性：多基因性状与量化遗传学</h2>
<p>到目前为止，我们主要讨论了由单个基因座决定的简单性状（例如，豌豆的颜色）。然而，大多数我们感兴趣的生物性状，如身高、体重、产量、疾病易感性等，都是由多个基因（多基因）以及环境因素共同决定的连续性状，这被称为<strong>多基因性状 (Polygenic Traits)</strong> 或 <strong>数量性状 (Quantitative Traits)</strong>。研究这些性状的遗传和演化，是<strong>数量遗传学 (Quantitative Genetics)</strong> 的核心内容。</p>
<h3 id="单基因-vs-多基因性状">单基因 vs. 多基因性状</h3>
<ul>
<li><strong>单基因性状 (Mendelian Traits):</strong> 由单个基因座决定，表现为离散的表型类别（例如，有或无，或几种明确的颜色）。它们的遗传模式遵循简单的孟德尔定律。</li>
<li><strong>多基因性状:</strong> 由多个基因共同作用，每个基因都对性状产生较小但累加的影响。此外，环境因素也可能对性状产生显著影响。它们的表型通常呈连续分布（如正态分布）。</li>
</ul>
<h3 id="遗传力：性状变异的可遗传性">遗传力：性状变异的可遗传性</h3>
<p>在数量遗传学中，最核心的概念之一是<strong>遗传力 (Heritability)</strong>。它衡量的是一个性状的表型变异中有多少比例是由遗传差异引起的。遗传力并不意味着性状完全由基因决定，也不意味着它是不可改变的。它只是一个统计量，反映了在特定环境和特定种群中，基因对表型变异的相对贡献。</p>
<p>遗传力分为两种：</p>
<h4 id="1-广义遗传力-H-2">1. 广义遗传力 (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>H</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">H^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>)</h4>
<p><strong>广义遗传力 (Broad-sense Heritability)</strong> 是指一个性状的总表型变异(<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>V</mi><mi>P</mi></msub></mrow><annotation encoding="application/x-tex">V_P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>)中，由遗传变异(<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>V</mi><mi>G</mi></msub></mrow><annotation encoding="application/x-tex">V_G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">G</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>)所占的比例：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>H</mi><mn>2</mn></msup><mo>=</mo><mfrac><msub><mi>V</mi><mi>G</mi></msub><msub><mi>V</mi><mi>P</mi></msub></mfrac></mrow><annotation encoding="application/x-tex">H^2 = \frac{V_G}{V_P} 
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8641em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.1963em;vertical-align:-0.836em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">G</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.836em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p>其中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>V</mi><mi>P</mi></msub><mo>=</mo><msub><mi>V</mi><mi>G</mi></msub><mo>+</mo><msub><mi>V</mi><mi>E</mi></msub></mrow><annotation encoding="application/x-tex">V_P = V_G + V_E</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">G</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">E</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>V</mi><mi>E</mi></msub></mrow><annotation encoding="application/x-tex">V_E</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">E</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>是环境变异。<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>V</mi><mi>G</mi></msub></mrow><annotation encoding="application/x-tex">V_G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">G</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>包括加性遗传变异、显性遗传变异和上位性遗传变异。</p>
<h4 id="2-狭义遗传力-h-2">2. 狭义遗传力 (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>h</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">h^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>)</h4>
<p><strong>狭义遗传力 (Narrow-sense Heritability)</strong> 是指一个性状的总表型变异(<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>V</mi><mi>P</mi></msub></mrow><annotation encoding="application/x-tex">V_P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>)中，由<strong>加性遗传变异 (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>V</mi><mi>A</mi></msub></mrow><annotation encoding="application/x-tex">V_A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>)</strong> 所占的比例：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>h</mi><mn>2</mn></msup><mo>=</mo><mfrac><msub><mi>V</mi><mi>A</mi></msub><msub><mi>V</mi><mi>P</mi></msub></mfrac></mrow><annotation encoding="application/x-tex">h^2 = \frac{V_A}{V_P} 
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8641em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.1963em;vertical-align:-0.836em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.836em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p>加性遗传变异是指等位基因以累加方式对性状产生影响的那部分遗传变异。狭义遗传力对于预测种群在选择作用下对性状的响应至关重要，因为它反映了亲代可以可靠地传递给子代的遗传变异。</p>
<p>狭义遗传力在人工选择和自然选择的背景下都具有重要的预测能力。选择响应 (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span>) 是指在一个选择世代后，种群平均表型值的变化。选择响应与狭义遗传力(<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>h</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">h^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>)和选择差(<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span>)之间存在一个简单的关系：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>R</mi><mo>=</mo><msup><mi>h</mi><mn>2</mn></msup><mi>S</mi></mrow><annotation encoding="application/x-tex">R = h^2 S 
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8641em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span></span></p>
<p>其中，选择差(<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span>)是指被选育亲代的平均表型值与原始种群平均表型值之差。这个公式被称为<strong>育种家方程 (Breeder’s Equation)</strong>，它是数量遗传学和育种学中的基石。</p>
<h3 id="基因-环境交互作用">基因-环境交互作用</h3>
<p>虽然遗传力量化了遗传对性状变异的贡献，但我们不能忽视环境。<strong>基因-环境交互作用 (Gene-Environment Interaction, GxE)</strong> 指的是一个基因型在不同环境下表现出不同的表型，或者说，环境对表型的影响取决于个体的基因型。例如，某些基因型在营养充足的环境下生长得很好，但在营养不良的环境下则表现不佳，而另一些基因型可能不受营养水平的显著影响。理解GxE是全面理解复杂性状形成和演化的关键。</p>
<h3 id="适应性景观：演化的可视化">适应性景观：演化的可视化</h3>
<p>由著名演化生物学家休厄尔·赖特 (Sewall Wright) 提出的<strong>适应性景观 (Fitness Landscape)</strong> 概念，是一种直观理解多基因演化过程的强大比喻。<br>
想象一个三维的“景观”：</p>
<ul>
<li>水平轴代表不同的基因型或等位基因频率组合（或性状值）。</li>
<li>垂直轴代表这些基因型组合所对应的适应度。</li>
</ul>
<p>这样，景观上会有“高峰”（高适应度基因型）和“谷地”（低适应度基因型）。演化过程可以被视为种群在适应性景观上通过自然选择（向高处攀爬）和遗传漂变（随机漂移）的“搜索”过程。</p>
<p>适应性景观可以帮助我们理解：</p>
<ul>
<li><strong>局部最优与全局最优:</strong> 种群可能被困在局部高峰，即使存在更高的全局高峰。</li>
<li><strong>演化轨迹:</strong> 不同的演化路径可能导致不同的适应度结果。</li>
<li><strong>多峰景观:</strong> 存在多个适应度高峰，这可能导致物种分化。</li>
<li><strong>适应性谷地:</strong> 某些基因型组合具有极低的适应度，种群难以穿越。</li>
</ul>
<p>然而，适应性景观是一个高度抽象和简化的模型。真实的基因型空间是高维的，且适应度本身可能随环境变化而动态变化。但它仍然是理解演化复杂性的有力思维工具。</p>
<hr>
<h2 id="四、-计算与建模：演化动力学的仿真">四、 计算与建模：演化动力学的仿真</h2>
<p>演化过程，特别是多基因性状的演化，涉及大量的基因、复杂的相互作用以及随机事件。解析解往往难以获得，或者过于简化。因此，<strong>计算模拟 (Computational Simulation)</strong> 成为了研究演化动力学不可或缺的工具。通过模拟，我们可以探索在不同参数和情景下，演化力量如何相互作用并塑造生命。</p>
<h3 id="为什么需要模拟？">为什么需要模拟？</h3>
<ul>
<li><strong>复杂性:</strong> 真实世界的演化系统包含无数个基因、复杂的调控网络、非线性的适应度景观和环境因素。</li>
<li><strong>非线性交互:</strong> 演化力量之间并非简单叠加，而是以非线性的方式相互作用。</li>
<li><strong>随机性:</strong> 遗传漂变、突变等过程本质上是随机的。</li>
<li><strong>时间尺度:</strong> 演化发生在巨大的时间尺度上，无法在实验室中直接观察其宏观过程。</li>
<li><strong>假设检验:</strong> 模拟允许我们改变特定参数并观察其影响，从而检验理论假设。</li>
</ul>
<h3 id="蒙特卡洛方法">蒙特卡洛方法</h3>
<p>许多演化模拟都采用了<strong>蒙特卡洛方法 (Monte Carlo Methods)</strong>，它利用随机数来解决问题。在遗传漂变模拟中，我们通过随机抽样来决定下一代等位基因的数量，这就是蒙特卡洛方法的一个简单应用。通过大量重复模拟，我们可以得到各种可能结果的概率分布，从而理解随机过程的长期行为。</p>
<h3 id="基于个体的模型-Agent-Based-Models-ABM">基于个体的模型 (Agent-Based Models, ABM)</h3>
<p><strong>基于个体的模型 (Agent-Based Models, ABM)</strong> 是一种强大的模拟范式，特别适用于模拟由大量相互作用的离散个体组成的系统。在演化动力学中，每个“个体”或“代理”代表一个生物体，它具有基因型、表型、适应度等属性，并遵循特定的行为规则（例如，繁殖、死亡、迁移、交配）。</p>
<p>ABM的优势在于：</p>
<ul>
<li><strong>微观细节:</strong> 可以直接模拟个体层面的事件，如突变、重组、交配。</li>
<li><strong>异质性:</strong> 允许个体之间存在差异。</li>
<li><strong>新兴行为:</strong> 群体层面的模式（如等位基因频率变化）可以从个体规则的简单组合中“涌现”出来。</li>
<li><strong>空间结构:</strong> 可以轻松地纳入空间维度，模拟扩散和局部相互作用。</li>
</ul>
<p>让我们尝试构建一个更复杂的ABM，模拟一个种群中同时受到自然选择和遗传漂变影响的等位基因频率变化。我们将追踪每个个体的基因型。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Individual</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;代表种群中的一个二倍体个体。&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, allele1, allele2</span>):</span><br><span class="line">        <span class="variable language_">self</span>.genotype = <span class="built_in">tuple</span>(<span class="built_in">sorted</span>((allele1, allele2))) <span class="comment"># 确保基因型表示一致，如 (&#x27;A&#x27;, &#x27;a&#x27;) 而非 (&#x27;a&#x27;, &#x27;A&#x27;)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__repr__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&quot;(<span class="subst">&#123;self.genotype[<span class="number">0</span>]&#125;</span><span class="subst">&#123;self.genotype[<span class="number">1</span>]&#125;</span>)&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_alleles</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> [<span class="variable language_">self</span>.genotype[<span class="number">0</span>], <span class="variable language_">self</span>.genotype[<span class="number">1</span>]]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">simulate_evolutionary_dynamics</span>(<span class="params"></span></span><br><span class="line"><span class="params">    initial_p, population_size, generations,</span></span><br><span class="line"><span class="params">    fitness_AA=<span class="number">1.0</span>, fitness_Aa=<span class="number">1.0</span>, fitness_aa=<span class="number">1.0</span>,</span></span><br><span class="line"><span class="params">    mutation_rate=<span class="number">0.0</span> <span class="comment"># 暂不考虑突变，专注于选择和漂变</span></span></span><br><span class="line"><span class="params"></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    模拟一个种群在选择和漂变作用下的演化。</span></span><br><span class="line"><span class="string">    initial_p: 初始等位基因A的频率</span></span><br><span class="line"><span class="string">    population_size: 种群大小 (N)</span></span><br><span class="line"><span class="string">    generations: 模拟的代数</span></span><br><span class="line"><span class="string">    fitness_AA, fitness_Aa, fitness_aa: 基因型相对适应度</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    allele_history = []</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 初始化种群</span></span><br><span class="line">    current_population = []</span><br><span class="line">    initial_num_A_alleles = <span class="built_in">int</span>(initial_p * <span class="number">2</span> * population_size)</span><br><span class="line">    initial_num_a_alleles = <span class="number">2</span> * population_size - initial_num_A_alleles</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 随机生成初始基因型，尽量匹配initial_p</span></span><br><span class="line">    <span class="comment"># 简单方法：随机分配等位基因，然后组合</span></span><br><span class="line">    alleles = [<span class="string">&#x27;A&#x27;</span>] * initial_num_A_alleles + [<span class="string">&#x27;a&#x27;</span>] * initial_num_a_alleles</span><br><span class="line">    np.random.shuffle(alleles) <span class="comment"># 打乱等位基因顺序</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(population_size):</span><br><span class="line">        <span class="comment"># 随机抽取两个等位基因形成一个个体（假设随机交配）</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(alleles) &gt;= <span class="number">2</span>:</span><br><span class="line">            allele1 = alleles.pop()</span><br><span class="line">            allele2 = alleles.pop()</span><br><span class="line">            current_population.append(Individual(allele1, allele2))</span><br><span class="line">        <span class="keyword">else</span>: <span class="comment"># 处理奇数个等位基因或不足的情况</span></span><br><span class="line">            <span class="comment"># 如果初始alleles不够，直接用HWE比例生成个体</span></span><br><span class="line">            p = initial_p</span><br><span class="line">            q = <span class="number">1</span> - p</span><br><span class="line">            rand = np.random.rand()</span><br><span class="line">            <span class="keyword">if</span> rand &lt; p**<span class="number">2</span>:</span><br><span class="line">                current_population.append(Individual(<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>))</span><br><span class="line">            <span class="keyword">elif</span> rand &lt; p**<span class="number">2</span> + <span class="number">2</span>*p*q:</span><br><span class="line">                current_population.append(Individual(<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;a&#x27;</span>))</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                current_population.append(Individual(<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;a&#x27;</span>))</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> gen <span class="keyword">in</span> <span class="built_in">range</span>(generations):</span><br><span class="line">        <span class="comment"># 1. 计算当前等位基因频率</span></span><br><span class="line">        total_A = <span class="number">0</span></span><br><span class="line">        total_alleles = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> individual <span class="keyword">in</span> current_population:</span><br><span class="line">            <span class="keyword">for</span> allele <span class="keyword">in</span> individual.get_alleles():</span><br><span class="line">                <span class="keyword">if</span> allele == <span class="string">&#x27;A&#x27;</span>:</span><br><span class="line">                    total_A += <span class="number">1</span></span><br><span class="line">                total_alleles += <span class="number">1</span></span><br><span class="line">        </span><br><span class="line">        p_current = total_A / total_alleles</span><br><span class="line">        allele_history.append(p_current)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> gen == generations - <span class="number">1</span>: <span class="comment"># 最后一轮不进行繁殖</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 2. 繁殖阶段（根据适应度进行抽样）</span></span><br><span class="line">        next_population = []</span><br><span class="line">        genotype_fitness = &#123;</span><br><span class="line">            (<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>): fitness_AA,</span><br><span class="line">            (<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;a&#x27;</span>): fitness_Aa,</span><br><span class="line">            (<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;a&#x27;</span>): fitness_aa</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 计算加权繁殖概率</span></span><br><span class="line">        weights = [genotype_fitness[ind.genotype] <span class="keyword">for</span> ind <span class="keyword">in</span> current_population]</span><br><span class="line">        total_weight = <span class="built_in">sum</span>(weights)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> total_weight == <span class="number">0</span>: <span class="comment"># 如果所有个体适应度为0，种群灭绝</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;警告: 种群在第 <span class="subst">&#123;gen&#125;</span> 代灭绝。&quot;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        reproduction_probabilities = [w / total_weight <span class="keyword">for</span> w <span class="keyword">in</span> weights]</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 从当前种群中选择 parents 产生下一代</span></span><br><span class="line">        <span class="comment"># 这里简化为直接从基因池中按频率抽取等位基因，即 Wright-Fisher 模型的思想</span></span><br><span class="line">        <span class="comment"># 更复杂的ABM会模拟配对和重组</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 根据当前频率和适应度，构建一个有效的基因池</span></span><br><span class="line">        weighted_alleles = []</span><br><span class="line">        <span class="keyword">for</span> ind <span class="keyword">in</span> current_population:</span><br><span class="line">            weight = genotype_fitness[ind.genotype]</span><br><span class="line">            weighted_alleles.extend([ind.genotype[<span class="number">0</span>]] * <span class="built_in">int</span>(weight * <span class="number">100</span>)) <span class="comment"># 放大权重，方便抽取</span></span><br><span class="line">            weighted_alleles.extend([ind.genotype[<span class="number">1</span>]] * <span class="built_in">int</span>(weight * <span class="number">100</span>))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> weighted_alleles: <span class="comment"># 确保基因池非空</span></span><br><span class="line">             <span class="built_in">print</span>(<span class="string">f&quot;警告: 在第 <span class="subst">&#123;gen&#125;</span> 代，加权基因池为空。&quot;</span>)</span><br><span class="line">             <span class="keyword">break</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(population_size):</span><br><span class="line">            <span class="comment"># 随机选择两个等位基因来创建新个体</span></span><br><span class="line">            parent_allele1 = np.random.choice(weighted_alleles)</span><br><span class="line">            parent_allele2 = np.random.choice(weighted_alleles)</span><br><span class="line">            next_population.append(Individual(parent_allele1, parent_allele2))</span><br><span class="line">            </span><br><span class="line">        current_population = next_population</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> allele_history</span><br><span class="line"></span><br><span class="line"><span class="comment"># 模拟场景</span></span><br><span class="line">initial_p = <span class="number">0.5</span></span><br><span class="line">generations = <span class="number">100</span></span><br><span class="line">population_size = <span class="number">50</span></span><br><span class="line"></span><br><span class="line">plt.figure(figsize=(<span class="number">14</span>, <span class="number">7</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 场景1: 纯漂变 (所有基因型适应度相同)</span></span><br><span class="line">plt.subplot(<span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>): <span class="comment"># 多次运行以展示随机性</span></span><br><span class="line">    history_drift = simulate_evolutionary_dynamics(initial_p, population_size, generations)</span><br><span class="line">    plt.plot(history_drift, label=<span class="string">f&#x27;Run <span class="subst">&#123;i+<span class="number">1</span>&#125;</span>&#x27;</span> <span class="keyword">if</span> i == <span class="number">0</span> <span class="keyword">else</span> <span class="string">&#x27;&#x27;</span>, alpha=<span class="number">0.7</span>)</span><br><span class="line">plt.title(<span class="string">f&#x27;遗传漂变 (N=<span class="subst">&#123;population_size&#125;</span>)&#x27;</span>, fontsize=<span class="number">16</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;代数&#x27;</span>, fontsize=<span class="number">14</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;等位基因A的频率 (p)&#x27;</span>, fontsize=<span class="number">14</span>)</span><br><span class="line">plt.ylim(<span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">plt.grid(<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 场景2: 定向选择 (AA适应度最高，a等位基因将被淘汰)</span></span><br><span class="line">plt.subplot(<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>)</span><br><span class="line">fitness_AA = <span class="number">1.0</span></span><br><span class="line">fitness_Aa = <span class="number">0.9</span></span><br><span class="line">fitness_aa = <span class="number">0.8</span> <span class="comment"># a等位基因降低适应度</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>): <span class="comment"># 多次运行以展示随机性，但选择倾向性会占主导</span></span><br><span class="line">    history_selection = simulate_evolutionary_dynamics(</span><br><span class="line">        initial_p, population_size, generations,</span><br><span class="line">        fitness_AA=fitness_AA, fitness_Aa=fitness_Aa, fitness_aa=fitness_aa</span><br><span class="line">    )</span><br><span class="line">    plt.plot(history_selection, label=<span class="string">f&#x27;Run <span class="subst">&#123;i+<span class="number">1</span>&#125;</span>&#x27;</span> <span class="keyword">if</span> i == <span class="number">0</span> <span class="keyword">else</span> <span class="string">&#x27;&#x27;</span>, alpha=<span class="number">0.7</span>)</span><br><span class="line">plt.title(<span class="string">f&#x27;定向选择与漂变 (N=<span class="subst">&#123;population_size&#125;</span>, w_AA=<span class="subst">&#123;fitness_AA&#125;</span>, w_Aa=<span class="subst">&#123;fitness_Aa&#125;</span>, w_aa=<span class="subst">&#123;fitness_aa&#125;</span>)&#x27;</span>, fontsize=<span class="number">16</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;代数&#x27;</span>, fontsize=<span class="number">14</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;等位基因A的频率 (p)&#x27;</span>, fontsize=<span class="number">14</span>)</span><br><span class="line">plt.ylim(<span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">plt.grid(<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">plt.tight_layout()</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 尝试异质优势 (Heterozygote Advantage) 稳定选择</span></span><br><span class="line">plt.figure(figsize=(<span class="number">7</span>, <span class="number">7</span>))</span><br><span class="line">fitness_AA = <span class="number">0.9</span></span><br><span class="line">fitness_Aa = <span class="number">1.0</span> <span class="comment"># 杂合子适应度最高</span></span><br><span class="line">fitness_aa = <span class="number">0.9</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">    history_hetero_advantage = simulate_evolutionary_dynamics(</span><br><span class="line">        initial_p, population_size, generations,</span><br><span class="line">        fitness_AA=fitness_AA, fitness_Aa=fitness_Aa, fitness_aa=fitness_aa</span><br><span class="line">    )</span><br><span class="line">    plt.plot(history_hetero_advantage, label=<span class="string">f&#x27;Run <span class="subst">&#123;i+<span class="number">1</span>&#125;</span>&#x27;</span> <span class="keyword">if</span> i == <span class="number">0</span> <span class="keyword">else</span> <span class="string">&#x27;&#x27;</span>, alpha=<span class="number">0.7</span>)</span><br><span class="line">plt.title(<span class="string">f&#x27;异质优势 (N=<span class="subst">&#123;population_size&#125;</span>, w_AA=<span class="subst">&#123;fitness_AA&#125;</span>, w_Aa=<span class="subst">&#123;fitness_Aa&#125;</span>, w_aa=<span class="subst">&#123;fitness_aa&#125;</span>)&#x27;</span>, fontsize=<span class="number">16</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;代数&#x27;</span>, fontsize=<span class="number">14</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;等位基因A的频率 (p)&#x27;</span>, fontsize=<span class="number">14</span>)</span><br><span class="line">plt.ylim(<span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">plt.grid(<span class="literal">True</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p>这个ABM比之前的漂变模拟更进一步，它考虑了个体的基因型和适应度。在“繁殖阶段”，我们根据个体的适应度赋予它们不同的“权重”来产生下一代，模拟了自然选择。同时，由于我们在固定大小的种群中进行随机抽样，遗传漂变效应也自然地包含在内。通过调整<code>fitness_AA</code>, <code>fitness_Aa</code>, <code>fitness_aa</code>的参数，你可以观察到定向选择、劣势（清除）选择、异质优势（维持多态性）等不同选择模式对等位基因频率轨迹的影响，同时也能看到小种群中漂变导致的随机波动。</p>
<h3 id="马尔可夫链">马尔可夫链</h3>
<p>Wright-Fisher模型和Moran模型，本质上都是<strong>马尔可夫链 (Markov Chains)</strong> 的应用。马尔可夫链是一种数学模型，描述了一系列事件，其中每个事件的概率只取决于前一个事件的状态。在群体遗传学中，当前一代的等位基因频率是“状态”，而下一代频率的概率分布只依赖于当前这一代的状态。这种无记忆性（过去的历史不影响未来，只取决于当前状态）使得马尔可夫链成为描述像遗传漂变这样的随机过程的强大工具。</p>
<h3 id="演化算法-Evolutionary-Algorithms">演化算法 (Evolutionary Algorithms)</h3>
<p>值得一提的是，生物演化过程也启发了一大类用于解决优化和计算问题的算法，统称为<strong>演化算法 (Evolutionary Algorithms)</strong>，例如<strong>遗传算法 (Genetic Algorithms, GA)</strong>、演化策略 (Evolution Strategies, ES) 和遗传编程 (Genetic Programming, GP)。这些算法通过模拟自然选择、突变、重组等机制，迭代地改进解的“种群”，最终找到最优或近似最优解。</p>
<p>然而，要明确的是，演化算法是<strong>受生物演化启发</strong>的<strong>优化工具</strong>，它们的目的与生物演化本身不同。生物演化是无目的的、盲目的过程，目标是“适应”，而非“优化”到某个预设的目标。演化算法则有明确的优化目标和适应度函数。尽管如此，它们在理解演化机制的计算效率和鲁棒性方面提供了宝贵的洞察。</p>
<hr>
<h2 id="五、-前沿与挑战：演化动力学的未来">五、 前沿与挑战：演化动力学的未来</h2>
<p>演化动力学与种群遗传学并非静态的学科，它们正随着新技术的出现和跨学科的融合而飞速发展。</p>
<h3 id="基因组学时代的群体遗传学">基因组学时代的群体遗传学</h3>
<p><strong>全基因组测序 (Whole-Genome Sequencing, WGS)</strong> 技术的飞速发展，使得我们能够以空前的精度和规模获取个体乃至整个种群的基因组数据。这为群体遗传学带来了革命性的变化：</p>
<ul>
<li><strong>全基因组关联研究 (Genome-Wide Association Studies, GWAS):</strong> 能够识别与复杂疾病和性状相关的基因位点。</li>
<li><strong>多基因风险评分 (Polygenic Risk Scores, PRS):</strong> 基于大量常见遗传变异，预测个体对某种疾病的遗传易感性。</li>
<li><strong>古DNA研究 (Ancient DNA, aDNA):</strong> 从古代遗骸中提取DNA，追溯人类乃至其他物种的演化历史和迁移模式，重构古种群的基因库变化。</li>
<li><strong>功能基因组学与非编码DNA:</strong> 随着对基因组理解的深入，我们认识到大量非编码DNA（曾经被称为“垃圾DNA”）在基因调控和表型形成中扮演重要角色，这为演化动力学研究带来了新的挑战和机遇。</li>
</ul>
<p>这些大数据为我们提供了前所未有的机会来检验和完善演化模型，发现新的演化规律。</p>
<h3 id="表观遗传学与演化">表观遗传学与演化</h3>
<p><strong>表观遗传学 (Epigenetics)</strong> 研究基因表达的可遗传变化，而这些变化并非由DNA序列本身的改变引起（例如DNA甲基化、组蛋白修饰）。传统演化理论主要基于DNA序列的改变，但表观遗传标记在某些情况下也可以稳定地从一代传递给下一代，并影响表型和适应度。这引发了新的问题：表观遗传变异是否以及如何影响演化轨迹？它是否能提供一种比DNA突变更快速的适应机制？这是一个活跃且充满争议的研究领域。</p>
<h3 id="文化演化与基因-文化协同演化">文化演化与基因-文化协同演化</h3>
<p>人类的演化不仅仅是生物学上的，更是文化上的。<strong>文化演化 (Cultural Evolution)</strong> 描述了文化信息（如知识、技能、信仰、规范）在个体之间传播和演变的过程。这个过程与生物演化有许多相似之处（变异、选择、传播）。</p>
<p>更进一步，<strong>基因-文化协同演化 (Gene-Culture Coevolution)</strong> 探讨了基因和文化之间的双向影响。例如，乳糖耐受基因的传播与人类养殖奶牛的文化实践紧密相关。文化实践改变了环境，从而对某些基因型施加了选择压力；反过来，某些基因型也可能影响文化传播和采纳的倾向。这种复杂的相互作用为理解人类独特演化路径提供了新的视角。</p>
<h3 id="演化医学：将演化思维应用于健康">演化医学：将演化思维应用于健康</h3>
<p><strong>演化医学 (Evolutionary Medicine)</strong>，或称达尔文医学，将演化原理应用于理解和解决人类健康与疾病问题。</p>
<ul>
<li><strong>抗生素耐药性:</strong> 细菌对药物的抵抗力是自然选择的经典案例。理解细菌的演化动力学有助于我们制定更有效的治疗策略和药物管理方案。</li>
<li><strong>癌症演化:</strong> 癌症本质上是细胞在体内的微演化过程。肿瘤内部的细胞不断突变、选择和扩散，理解其演化动力学对于开发新的抗癌疗法至关重要。</li>
<li><strong>慢性疾病的演化根源:</strong> 许多现代慢性病（如肥胖、糖尿病、心血管疾病）可能与我们远古祖先在不同环境下的适应性演化有关。演化医学提供了独特的视角来理解这些疾病的“为什么”。</li>
</ul>
<h3 id="开放问题与未来方向">开放问题与未来方向</h3>
<p>尽管取得了巨大进展，演化动力学和种群遗传学仍面临许多未解决的挑战：</p>
<ul>
<li><strong>基因组复杂性:</strong> 如何在高维基因组空间中理解选择的作用，以及非编码区域和表观遗传修饰的演化？</li>
<li><strong>多基因性和相互作用:</strong> 如何精确建模多个基因、环境因素以及基因之间复杂相互作用对性状和适应度的影响？</li>
<li><strong>宏演化过程:</strong> 如何将微演化过程（等位基因频率变化）与宏演化过程（物种形成、大尺度适应辐射）联系起来？</li>
<li><strong>大数据与AI:</strong> 如何有效利用海量的基因组和表型数据，并结合机器学习和人工智能技术来发现新的演化规律和预测未来演化趋势？</li>
</ul>
<hr>
<h2 id="结论">结论</h2>
<p>我们已经一同走过了一段引人入胜的旅程，从孟德尔豌豆的颗粒性遗传，到哈迪-温伯格平衡的数学优雅，再到自然选择和遗传漂变如何塑造基因频率的动态过程。我们探讨了多基因性状的复杂性，以及计算模拟在理解这些复杂系统中的不可替代性。最后，我们展望了基因组学、表观遗传学、文化演化以及演化医学等前沿领域，它们正在不断拓展我们对生命演变的认知边界。</p>
<p>演化动力学与种群遗传学，远不止是一堆公式和概念。它们提供了一个强大的框架，让我们能够以量化、可预测的方式理解生命如何适应、如何多样化、如何与环境互动。它揭示了我们自身以及地球上所有生命形态的深层规律。从微生物的抗药性到人类文明的兴衰，演化的力量无处不在，塑造着万物的现在与未来。</p>
<p>作为技术和数学的爱好者，我希望这篇博客能激发你进一步探索的好奇心。去深入研究那些漂亮的微分方程，去编写你自己的演化模拟，去运用你所学的知识，去解码更多生命变迁的数学旋律。你会发现，演化不仅是生物学的核心，更是理解复杂系统、随机过程和优化策略的绝佳范例。</p>
<p>感谢你的阅读，我们下期再见！</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a target="_blank" rel="noopener" href="https://github.com/qmwneb946">qmwneb946</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://qmwneb946.dpdns.org/2025/07/22/2025-07-22-211902/">https://qmwneb946.dpdns.org/2025/07/22/2025-07-22-211902/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://opensource.org/licenses/MIT" target="_blank">MIT License</a> 许可协议。转载请注明来源 <a href="https://qmwneb946.dpdns.org" target="_blank">qmwneb946 的博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/2025/">2025</a><a class="post-meta__tags" href="/tags/%E6%95%B0%E5%AD%A6/">数学</a><a class="post-meta__tags" href="/tags/%E6%BC%94%E5%8C%96%E5%8A%A8%E5%8A%9B%E5%AD%A6%E4%B8%8E%E7%A7%8D%E7%BE%A4%E9%81%97%E4%BC%A0%E5%AD%A6/">演化动力学与种群遗传学</a></div><div class="post-share"><div class="social-share" data-image="/img/icon.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/07/22/2025-07-22-212009/" title="探索无尽可能：旅行商问题近似解的深度剖析"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">探索无尽可能：旅行商问题近似解的深度剖析</div></div><div class="info-2"><div class="info-item-1">你好，我是 qmwneb946，一个对技术和数学痴迷的博主。今天，我们要踏上一段扣人心弦的旅程，深入探索一个古老而又充满活力的计算机科学与优化领域的经典难题——旅行商问题（Traveling Salesperson Problem, TSP）。这个看似简单的任务，背后却隐藏着惊人的计算复杂性，迫使我们超越完美，拥抱“足够好”的智慧。 引言：从邮差的烦恼到NP-难的迷思 想象一下：你是一名需要拜访多个城市的销售员，为了节省时间和燃油，你希望找到一条最短的路线，从某个城市出发，访问所有指定城市一次且仅一次，最后返回起点。这个看似普通的日常挑战，正是著名的旅行商问题 (TSP) 的核心。 自18世纪以来，数学家们便开始研究这类路径优化问题。TSP不仅在物流、调度、制造（如钻孔、电路板布线）等实际领域有着广泛的应用，更在理论计算机科学中占据着举足轻重的地位。它是NP-难 (NP-hard) 问题家族的典型代表。这意味着，对于大规模的城市数量，即使是最强大的超级计算机，也无法在可接受的时间内找到其精确的最优解。当城市数量 nnn 增加时，暴力枚举所有可能的路径需要的时间复杂度是惊人的 O(...</div></div></div></a><a class="pagination-related" href="/2025/07/22/2025-07-22-211752/" title="探索分形市场假说：金融世界的混沌与秩序"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">探索分形市场假说：金融世界的混沌与秩序</div></div><div class="info-2"><div class="info-item-1">你好，我是 qmwneb946，一名专注于技术与数学交叉领域的博主。今天，我们将一同深入一个引人入胜的话题——“分形市场假说”（Fractal Market Hypothesis, FMH）。在金融市场的复杂性面前，传统的理论往往显得捉襟见肘，而分形市场假说则为我们提供了一个全新的、富有洞见的视角，去理解价格波动背后的混沌与秩序。 引言 长期以来，金融学界的主流观点，特别是有效市场假说（Efficient Market Hypothesis, EMH），一直主导着我们对金融市场行为的理解。EMH 认为，市场价格已经充分反映了所有可获取的信息，因此，投资者无法持续性地通过分析信息获得超额收益。这一理论简洁而优雅，但现实世界的几次金融危机、泡沫的形成与破裂、以及投资者普遍存在的非理性行为，都不断冲击着 EMH 的基石。市场真的如此“有效”和“理性”吗？价格真的是无迹可寻的随机游走吗？ 答案可能并非如此简单。当我们将目光转向大自然，会发现许多看似无序的现象背后，隐藏着深刻的数学规律——分形。从海岸线的曲折到树叶的脉络，从云朵的形态到血管的分布，分形无处不在。那么，如果金融市场也是一个复...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/07/18/2025-07-18-082519/" title="增强现实与工业维修：一场效率革命"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-18</div><div class="info-item-2">增强现实与工业维修：一场效率革命</div></div><div class="info-2"><div class="info-item-1">增强现实 (AR) 技术正以前所未有的速度改变着我们的生活，而其在工业维修领域的应用更是展现出了巨大的潜力。不再局限于科幻电影中的场景，AR 如今已成为提升维修效率、降低维护成本、提高安全性的强大工具。本文将深入探讨 AR 如何与工业维修相结合，并分析其背后的技术和未来发展趋势。 引言：传统工业维修的挑战 传统的工业维修往往面临着诸多挑战：  信息获取困难: 维修人员需要查阅大量的纸质文档、图纸和视频，耗时费力，容易出错。 培训成本高昂:  熟练技工的培养需要漫长的学习过程和大量的实践经验，成本高昂。 安全风险较高:  一些复杂的设备维修存在高风险，例如高压电、高温部件等，容易发生意外事故。 维修效率低下:  由于缺乏实时信息和有效的指导，维修时间往往较长，导致生产停机时间增加，损失巨大。  AR 如何改变工业维修的游戏规则 AR 技术通过将数字信息叠加到现实世界中，为工业维修提供了全新的解决方案： 远程专家指导 通过 AR 眼镜或平板电脑，现场维修人员可以与远程专家实时互动。专家可以通过 AR 系统看到现场设备的实时图像，并利用虚拟标注、3D 模型等工具进行远程指导，大大缩短了...</div></div></div></a><a class="pagination-related" href="/2025/07/18/2025-07-18-082652/" title="纳米材料在靶向药物中的革命性应用"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-18</div><div class="info-item-2">纳米材料在靶向药物中的革命性应用</div></div><div class="info-2"><div class="info-item-1">近年来，癌症等重大疾病的治疗面临着巨大的挑战，传统的化疗药物往往毒性大、副作用强，难以实现精准治疗。而纳米技术的兴起为解决这一难题提供了新的思路，特别是纳米材料在靶向药物递送系统中的应用，正引发一场医学革命。本文将深入探讨纳米材料如何提升靶向药物的疗效，降低其毒副作用。 纳米材料的特性及其在药物递送中的优势 纳米材料，是指至少在一个维度上尺寸小于100纳米的材料。这种极小的尺寸赋予了它们许多独特的物理和化学性质，使其在药物递送领域具有显著优势： 增强的药物溶解度和稳定性 许多药物具有较低的溶解度，限制了其在体内的吸收和生物利用度。纳米载体，例如脂质体、聚合物纳米颗粒和无机纳米颗粒（如金纳米颗粒、氧化铁纳米颗粒），可以显著提高药物的溶解度和稳定性，延长其在体内的循环时间。例如，将抗癌药物负载在聚合物纳米颗粒中，可以保护药物免受降解，并提高其在肿瘤组织中的积累。 靶向药物递送 纳米材料可以通过表面修饰，例如结合特异性配体（如抗体、肽或小分子），实现对特定细胞或组织的靶向递送。这种靶向递送可以最大限度地减少药物对健康组织的毒性，并提高药物在靶标部位的浓度，从而增强治疗效果。例如，修饰有...</div></div></div></a><a class="pagination-related" href="/2025/07/18/2025-07-18-082925/" title="生物化学中的蛋白质折叠问题：一个复杂而迷人的计算挑战"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-18</div><div class="info-item-2">生物化学中的蛋白质折叠问题：一个复杂而迷人的计算挑战</div></div><div class="info-2"><div class="info-item-1">生命，这奇妙的现象，其本质很大程度上取决于蛋白质的精确三维结构。蛋白质是由氨基酸链组成的长链分子，但仅仅是氨基酸序列并不能完全决定其功能。蛋白质必须折叠成特定的三维结构（构象），才能发挥其生物学功能，例如催化酶促反应、运输分子或构建细胞结构。  而这个折叠过程，就是著名的“蛋白质折叠问题”。 蛋白质折叠：从线性序列到三维结构 蛋白质的氨基酸序列由基因编码决定，这是一个线性的一维结构。然而，这些氨基酸链并非随机地盘踞在一起，而是会遵循特定的物理和化学原理，自发地折叠成独特的、功能性的三维结构。这个折叠过程涉及到多种相互作用，包括： 疏水相互作用 蛋白质内部的疏水氨基酸残基倾向于聚集在一起，远离水性环境，形成蛋白质的核心区域。而亲水性氨基酸残基则倾向于暴露在蛋白质的表面，与水分子相互作用。 静电相互作用 带电荷的氨基酸残基之间会发生静电吸引或排斥作用，影响蛋白质的折叠。 氢键 氢键在维持蛋白质二级结构（例如α螺旋和β折叠）中起着关键作用。 二硫键 某些氨基酸残基（例如半胱氨酸）之间可以形成二硫键，进一步稳定蛋白质的三维结构。 这些相互作用共同决定了蛋白质的最终构象，这是一个极其复杂的...</div></div></div></a><a class="pagination-related" href="/2025/07/18/2025-07-18-092536/" title="CRISPR基因编辑：技术的奇迹与伦理的挑战"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-18</div><div class="info-item-2">CRISPR基因编辑：技术的奇迹与伦理的挑战</div></div><div class="info-2"><div class="info-item-1">大家好！我是你们的技术和数学博主，今天我们要深入探讨一个既令人兴奋又充满争议的话题：CRISPR-Cas9基因编辑技术及其伦理挑战。CRISPR技术以其精准性和效率，为治疗遗传疾病、改良作物等领域带来了革命性的变革，但与此同时，它也引发了诸多伦理难题，需要我们认真思考和谨慎应对。 CRISPR技术：一把双刃剑 CRISPR-Cas9系统，简单来说，就是一种可以精确地“剪切和粘贴”DNA的工具。它源自细菌的天然防御机制，利用向导RNA（gRNA）引导Cas9酶到基因组中的特定位置，从而进行基因的敲除、插入或替换。其操作简便、成本低廉、效率高，使其成为基因编辑领域的“明星”技术。 CRISPR的工作原理 CRISPR系统的工作机制可以概括为以下几个步骤：  设计gRNA:  根据目标基因序列设计相应的gRNA，使其能够特异性地结合目标DNA序列。 Cas9酶的结合: gRNA引导Cas9酶到目标DNA序列。 DNA双链断裂: Cas9酶在目标位点切割DNA双链，形成双链断裂（DSB）。 DNA修复: 细胞利用非同源末端连接（NHEJ）或同源定向修复（HDR）机制修复DSB。NHEJ修...</div></div></div></a><a class="pagination-related" href="/2025/07/18/2025-07-18-094115/" title="免疫学与癌症免疫疗法：一场人体内部的战争与和平"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-18</div><div class="info-item-2">免疫学与癌症免疫疗法：一场人体内部的战争与和平</div></div><div class="info-2"><div class="info-item-1">免疫系统，人体精妙的防御机制，日夜不停地抵御着病毒、细菌和其他有害物质的入侵。然而，当这套系统出现故障，对自身细胞发起攻击，或者无法有效清除癌细胞时，疾病便会发生，其中最可怕的莫过于癌症。近年来，癌症免疫疗法异军突起，为癌症治疗带来了新的希望，让我们深入探索这场人体内部的战争与和平。 免疫系统：人体精妙的防御网络 我们的免疫系统由先天免疫和适应性免疫两大支柱组成。 先天免疫：第一道防线 先天免疫是人体抵御病原体的第一道防线，它包含物理屏障（例如皮肤和黏膜）、化学屏障（例如胃酸和酶）以及细胞介导的免疫反应，例如巨噬细胞和自然杀伤细胞（NK细胞）的吞噬和杀伤作用。这些细胞能够识别并清除被感染的细胞或癌细胞，但其特异性较低。 适应性免疫：精准打击 适应性免疫系统则更为精细，它具有特异性和记忆性。T细胞和B细胞是适应性免疫的主角。T细胞负责细胞介导的免疫，其中细胞毒性T细胞（CTL）能够特异性识别并杀死靶细胞，例如被病毒感染的细胞或癌细胞。B细胞则负责体液免疫，产生抗体，中和病原体或标记癌细胞以便清除。  抗原呈递细胞（APC），例如树突状细胞，在将抗原信息呈递给T细胞，启动适应性免疫反...</div></div></div></a><a class="pagination-related" href="/2025/07/18/2025-07-18-094141/" title="生态学中的生物多样性保护：一个复杂系统工程的视角"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-18</div><div class="info-item-2">生态学中的生物多样性保护：一个复杂系统工程的视角</div></div><div class="info-2"><div class="info-item-1">大家好！今天我们要深入探讨一个既充满挑战又至关重要的话题：生态学中的生物多样性保护。  这不仅是环境保护的基石，也与我们人类的福祉息息相关。对技术爱好者来说，这更像是一个巨大的、复杂的系统工程，充满了需要解决的优化问题和值得探索的算法。 生物多样性的价值：超越简单的物种数量 我们通常将生物多样性理解为物种数量的多样性。但实际上，它是一个多层次的概念，包括：  遗传多样性 (Genetic Diversity):  同一物种内基因组的差异性，这决定了物种的适应性和进化潜力。  想象一下，一个抗旱基因的缺失可能导致整个小麦品种在干旱年份面临灭绝的风险。 物种多样性 (Species Diversity):  不同物种的数量及其相对丰度。 这通常用Shannon多样性指数 (H=−∑i=1Spilog⁡2piH = -\sum_{i=1}^{S} p_i \log_2 p_iH=−∑i=1S​pi​log2​pi​) 来衡量，其中 pip_ipi​ 是第 iii 个物种的比例，SSS 是物种总数。  更高的Shannon指数表示更高的物种多样性。 生态系统多样性 (Ecosystem ...</div></div></div></a></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="giscus-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/icon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">qmwneb946</div><div class="author-info-description">一个专注于技术分享的个人博客，涵盖编程、算法、系统设计等内容</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">633</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">637</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">4</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/qmwneb946"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/qmwneb946" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:qmwneb946@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">代码与远方，技术与生活交织的篇章。</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81-%E5%9F%BA%E7%9F%B3%EF%BC%9A%E5%AD%9F%E5%BE%B7%E5%B0%94%E9%81%97%E4%BC%A0%E4%B8%8E%E7%BE%A4%E4%BD%93%E9%81%97%E4%BC%A0%E5%AD%A6%E5%8E%9F%E7%90%86"><span class="toc-number">1.</span> <span class="toc-text">一、 基石：孟德尔遗传与群体遗传学原理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%9F%E5%BE%B7%E5%B0%94%E5%AE%9A%E5%BE%8B%E7%9A%84%E9%87%8D%E6%96%B0%E5%AE%A1%E8%A7%86"><span class="toc-number">1.1.</span> <span class="toc-text">孟德尔定律的重新审视</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BE%A4%E4%BD%93%E9%81%97%E4%BC%A0%E5%AD%A6%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="toc-number">1.2.</span> <span class="toc-text">群体遗传学的基本概念</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%9F%BA%E5%9B%A0%E5%BA%93%E4%B8%8E%E7%AD%89%E4%BD%8D%E5%9F%BA%E5%9B%A0%E9%A2%91%E7%8E%87"><span class="toc-number">1.2.1.</span> <span class="toc-text">1. 基因库与等位基因频率</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%9F%BA%E5%9B%A0%E5%9E%8B%E9%A2%91%E7%8E%87"><span class="toc-number">1.2.2.</span> <span class="toc-text">2. 基因型频率</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E5%93%88%E8%BF%AA-%E6%B8%A9%E4%BC%AF%E6%A0%BC%E5%B9%B3%E8%A1%A1%EF%BC%9A%E6%BC%94%E5%8C%96%E7%9A%84%E2%80%9C%E9%9B%B6%E5%81%87%E8%AE%BE%E2%80%9D"><span class="toc-number">1.2.3.</span> <span class="toc-text">3. 哈迪-温伯格平衡：演化的“零假设”</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%81%97%E4%BC%A0%E5%8F%98%E5%BC%82%E7%9A%84%E6%9D%A5%E6%BA%90"><span class="toc-number">1.3.</span> <span class="toc-text">遗传变异的来源</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81-%E9%A9%B1%E5%8A%A8%E5%8A%9B%EF%BC%9A%E6%BC%94%E5%8C%96%E6%9C%BA%E5%88%B6%E7%9A%84%E5%8A%A8%E5%8A%9B%E5%AD%A6%E5%88%86%E6%9E%90"><span class="toc-number">2.</span> <span class="toc-text">二、 驱动力：演化机制的动力学分析</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E7%84%B6%E9%80%89%E6%8B%A9%EF%BC%9A%E9%80%82%E5%BA%94%E5%BA%A6%E4%B8%8E%E7%94%9F%E5%AD%98%E6%96%97%E4%BA%89%E7%9A%84%E9%87%8F%E5%8C%96"><span class="toc-number">2.1.</span> <span class="toc-text">自然选择：适应度与生存斗争的量化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%89%E6%8B%A9%E7%9A%84%E7%B1%BB%E5%9E%8B"><span class="toc-number">2.2.</span> <span class="toc-text">选择的类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%81%97%E4%BC%A0%E6%BC%82%E5%8F%98%EF%BC%9A%E9%9A%8F%E6%9C%BA%E7%9A%84%E5%8A%9B%E9%87%8F"><span class="toc-number">2.3.</span> <span class="toc-text">遗传漂变：随机的力量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AA%81%E5%8F%98%EF%BC%9A%E5%8F%98%E5%BC%82%E7%9A%84%E7%BB%88%E6%9E%81%E6%9D%A5%E6%BA%90"><span class="toc-number">2.4.</span> <span class="toc-text">突变：变异的终极来源</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E5%9B%A0%E6%B5%81%EF%BC%9A%E8%BF%9E%E6%8E%A5%E7%A7%8D%E7%BE%A4%E7%9A%84%E7%BA%BD%E5%B8%A6"><span class="toc-number">2.5.</span> <span class="toc-text">基因流：连接种群的纽带</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81-%E5%A4%8D%E6%9D%82%E6%80%A7%EF%BC%9A%E5%A4%9A%E5%9F%BA%E5%9B%A0%E6%80%A7%E7%8A%B6%E4%B8%8E%E9%87%8F%E5%8C%96%E9%81%97%E4%BC%A0%E5%AD%A6"><span class="toc-number">3.</span> <span class="toc-text">三、 复杂性：多基因性状与量化遗传学</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%95%E5%9F%BA%E5%9B%A0-vs-%E5%A4%9A%E5%9F%BA%E5%9B%A0%E6%80%A7%E7%8A%B6"><span class="toc-number">3.1.</span> <span class="toc-text">单基因 vs. 多基因性状</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%81%97%E4%BC%A0%E5%8A%9B%EF%BC%9A%E6%80%A7%E7%8A%B6%E5%8F%98%E5%BC%82%E7%9A%84%E5%8F%AF%E9%81%97%E4%BC%A0%E6%80%A7"><span class="toc-number">3.2.</span> <span class="toc-text">遗传力：性状变异的可遗传性</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%B9%BF%E4%B9%89%E9%81%97%E4%BC%A0%E5%8A%9B-H-2"><span class="toc-number">3.2.1.</span> <span class="toc-text">1. 广义遗传力 (H2H^2H2)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E7%8B%AD%E4%B9%89%E9%81%97%E4%BC%A0%E5%8A%9B-h-2"><span class="toc-number">3.2.2.</span> <span class="toc-text">2. 狭义遗传力 (h2h^2h2)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E5%9B%A0-%E7%8E%AF%E5%A2%83%E4%BA%A4%E4%BA%92%E4%BD%9C%E7%94%A8"><span class="toc-number">3.3.</span> <span class="toc-text">基因-环境交互作用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%82%E5%BA%94%E6%80%A7%E6%99%AF%E8%A7%82%EF%BC%9A%E6%BC%94%E5%8C%96%E7%9A%84%E5%8F%AF%E8%A7%86%E5%8C%96"><span class="toc-number">3.4.</span> <span class="toc-text">适应性景观：演化的可视化</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81-%E8%AE%A1%E7%AE%97%E4%B8%8E%E5%BB%BA%E6%A8%A1%EF%BC%9A%E6%BC%94%E5%8C%96%E5%8A%A8%E5%8A%9B%E5%AD%A6%E7%9A%84%E4%BB%BF%E7%9C%9F"><span class="toc-number">4.</span> <span class="toc-text">四、 计算与建模：演化动力学的仿真</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81%E6%A8%A1%E6%8B%9F%EF%BC%9F"><span class="toc-number">4.1.</span> <span class="toc-text">为什么需要模拟？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%92%99%E7%89%B9%E5%8D%A1%E6%B4%9B%E6%96%B9%E6%B3%95"><span class="toc-number">4.2.</span> <span class="toc-text">蒙特卡洛方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8E%E4%B8%AA%E4%BD%93%E7%9A%84%E6%A8%A1%E5%9E%8B-Agent-Based-Models-ABM"><span class="toc-number">4.3.</span> <span class="toc-text">基于个体的模型 (Agent-Based Models, ABM)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A9%AC%E5%B0%94%E5%8F%AF%E5%A4%AB%E9%93%BE"><span class="toc-number">4.4.</span> <span class="toc-text">马尔可夫链</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BC%94%E5%8C%96%E7%AE%97%E6%B3%95-Evolutionary-Algorithms"><span class="toc-number">4.5.</span> <span class="toc-text">演化算法 (Evolutionary Algorithms)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94%E3%80%81-%E5%89%8D%E6%B2%BF%E4%B8%8E%E6%8C%91%E6%88%98%EF%BC%9A%E6%BC%94%E5%8C%96%E5%8A%A8%E5%8A%9B%E5%AD%A6%E7%9A%84%E6%9C%AA%E6%9D%A5"><span class="toc-number">5.</span> <span class="toc-text">五、 前沿与挑战：演化动力学的未来</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E5%9B%A0%E7%BB%84%E5%AD%A6%E6%97%B6%E4%BB%A3%E7%9A%84%E7%BE%A4%E4%BD%93%E9%81%97%E4%BC%A0%E5%AD%A6"><span class="toc-number">5.1.</span> <span class="toc-text">基因组学时代的群体遗传学</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A1%A8%E8%A7%82%E9%81%97%E4%BC%A0%E5%AD%A6%E4%B8%8E%E6%BC%94%E5%8C%96"><span class="toc-number">5.2.</span> <span class="toc-text">表观遗传学与演化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E5%8C%96%E6%BC%94%E5%8C%96%E4%B8%8E%E5%9F%BA%E5%9B%A0-%E6%96%87%E5%8C%96%E5%8D%8F%E5%90%8C%E6%BC%94%E5%8C%96"><span class="toc-number">5.3.</span> <span class="toc-text">文化演化与基因-文化协同演化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BC%94%E5%8C%96%E5%8C%BB%E5%AD%A6%EF%BC%9A%E5%B0%86%E6%BC%94%E5%8C%96%E6%80%9D%E7%BB%B4%E5%BA%94%E7%94%A8%E4%BA%8E%E5%81%A5%E5%BA%B7"><span class="toc-number">5.4.</span> <span class="toc-text">演化医学：将演化思维应用于健康</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%80%E6%94%BE%E9%97%AE%E9%A2%98%E4%B8%8E%E6%9C%AA%E6%9D%A5%E6%96%B9%E5%90%91"><span class="toc-number">5.5.</span> <span class="toc-text">开放问题与未来方向</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%93%E8%AE%BA"><span class="toc-number">6.</span> <span class="toc-text">结论</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/07/23/hello-world/" title="Hello World">Hello World</a><time datetime="2025-07-23T05:13:21.747Z" title="发表于 2025-07-23 13:13:21">2025-07-23</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/07/23/%E5%8D%9A%E5%BC%88%E8%AE%BA%E5%9F%BA%E7%A1%80/" title="博弈论基础">博弈论基础</a><time datetime="2025-07-23T05:13:21.747Z" title="发表于 2025-07-23 13:13:21">2025-07-23</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/07/22/2025-07-23-051108/" title="容器安全技术与实践：构建无懈可击的云原生防线">容器安全技术与实践：构建无懈可击的云原生防线</a><time datetime="2025-07-22T21:11:08.000Z" title="发表于 2025-07-23 05:11:08">2025-07-23</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/07/22/2025-07-23-051002/" title="深入理解DAO的法律与监管问题：去中心化前沿的秩序与混沌">深入理解DAO的法律与监管问题：去中心化前沿的秩序与混沌</a><time datetime="2025-07-22T21:10:02.000Z" title="发表于 2025-07-23 05:10:02">2025-07-23</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/07/22/2025-07-23-050920/" title="联邦学习的激励机制：赋能协作式AI的经济学与博弈论视角">联邦学习的激励机制：赋能协作式AI的经济学与博弈论视角</a><time datetime="2025-07-22T21:09:20.000Z" title="发表于 2025-07-23 05:09:20">2025-07-23</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;2025 By qmwneb946</span><span class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.4.2</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="前往评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"><script>(async () => {
  const showKatex = () => {
    document.querySelectorAll('#article-container .katex').forEach(el => el.classList.add('katex-show'))
  }

  if (!window.katex_js_css) {
    window.katex_js_css = true
    await btf.getCSS('https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css')
    if (true) {
      await btf.getScript('https://cdn.jsdelivr.net/npm/katex/dist/contrib/copy-tex.min.js')
    }
  }

  showKatex()
})()</script><script>(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.pageType === 'shuoshuo'
  const option = null

  const getGiscusTheme = theme => theme === 'dark' ? 'dark' : 'light'

  const createScriptElement = config => {
    const ele = document.createElement('script')
    Object.entries(config).forEach(([key, value]) => {
      ele.setAttribute(key, value)
    })
    return ele
  }

  const loadGiscus = (el = document, key) => {
    const mappingConfig = isShuoshuo
      ? { 'data-mapping': 'specific', 'data-term': key }
      : { 'data-mapping': (option && option['data-mapping']) || 'pathname' }

    const giscusConfig = {
      src: 'https://giscus.app/client.js',
      'data-repo': 'qmwneb946/blog',
      'data-repo-id': 'R_kgDOPM6cWw',
      'data-category-id': 'DIC_kwDOPM6cW84CtEzo',
      'data-theme': getGiscusTheme(document.documentElement.getAttribute('data-theme')),
      'data-reactions-enabled': '1',
      crossorigin: 'anonymous',
      async: true,
      ...option,
      ...mappingConfig
    }

    const scriptElement = createScriptElement(giscusConfig)

    el.querySelector('#giscus-wrap').appendChild(scriptElement)

    if (isShuoshuo) {
      window.shuoshuoComment.destroyGiscus = () => {
        if (el.children.length) {
          el.innerHTML = ''
          el.classList.add('no-comment')
        }
      }
    }
  }

  const changeGiscusTheme = theme => {
    const iframe = document.querySelector('#giscus-wrap iframe')
    if (iframe) {
      const message = {
        giscus: {
          setConfig: {
            theme: getGiscusTheme(theme)
          }
        }
      }
      iframe.contentWindow.postMessage(message, 'https://giscus.app')
    }
  }

  btf.addGlobalFn('themeChange', changeGiscusTheme, 'giscus')

  if (isShuoshuo) {
    'Giscus' === 'Giscus'
      ? window.shuoshuoComment = { loadComment: loadGiscus }
      : window.loadOtherComment = loadGiscus
    return
  }

  if ('Giscus' === 'Giscus' || !false) {
    if (false) btf.loadComment(document.getElementById('giscus-wrap'), loadGiscus)
    else loadGiscus()
  } else {
    window.loadOtherComment = loadGiscus
  }
})()</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>